# Top K Frequent Elements: ì„±ëŠ¥ ë¹„êµ ë¶„ì„

## ğŸ“Š ì‹¤ì œ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼

### í…ŒìŠ¤íŠ¸ í™˜ê²½
- ê° í…ŒìŠ¤íŠ¸: 100íšŒ ë°˜ë³µ ì‹¤í–‰ (í° ë°°ì—´ì€ 10íšŒ)
- ì¸¡ì • ë°©ë²•: `performance.now()`
- ì‹¤í–‰ í™˜ê²½: Node.js with V8 Engine

## ğŸ† ì¢…í•© ê²°ê³¼

| Method | ìŠ¹ìˆ˜ | ìŠ¹ë¥  |
|--------|------|------|
| **Method 1 (Sort)** | 5ìŠ¹ ğŸ”´ | 55.6% |
| **Method 2 (Bucket Sort)** | 4ìŠ¹ ğŸ”µ | 44.4% |

**ê²°ë¡ **: Sort ë°©ì‹ì´ ê·¼ì†Œí•˜ê²Œ ìš°ì„¸

---

## ğŸ“ˆ ì‹œë‚˜ë¦¬ì˜¤ë³„ ìƒì„¸ ê²°ê³¼

### ğŸ”´ Sortê°€ ìŠ¹ë¦¬í•œ ê²½ìš° (5ìŠ¹)

#### 1. ì‘ì€ ë°°ì—´ + ë‚®ì€ unique (1%)
```
n = 1,000, unique â‰ˆ 10, k = 5
Method 1 (Sort):   0.030ms
Method 2 (Bucket): 0.082ms
ìŠ¹ì: Method 1 (170.7% ë” ë¹ ë¦„) â­â­â­
```

#### 2. ì‘ì€ ë°°ì—´ + ì¤‘ê°„ unique (30%)
```
n = 1,000, unique â‰ˆ 300, k = 5
Method 1 (Sort):   0.056ms
Method 2 (Bucket): 0.059ms
ìŠ¹ì: Method 1 (5.6% ë” ë¹ ë¦„)
```

#### 3. ì¤‘ê°„ ë°°ì—´ + ë‚®ì€ unique (1%)
```
n = 10,000, unique â‰ˆ 100, k = 10
Method 1 (Sort):   0.427ms
Method 2 (Bucket): 0.565ms
ìŠ¹ì: Method 1 (32.3% ë” ë¹ ë¦„)
```

#### 4. í° ë°°ì—´ + ë‚®ì€ unique (1%)
```
n = 100,000, unique â‰ˆ 1,000, k = 10
Method 1 (Sort):   3.271ms
Method 2 (Bucket): 7.512ms
ìŠ¹ì: Method 1 (129.6% ë” ë¹ ë¦„) â­â­â­
```

#### 5. í° ë°°ì—´ + ì¤‘ê°„ unique (30%)
```
n = 100,000, unique â‰ˆ 30,000, k = 10
Method 1 (Sort):   8.068ms
Method 2 (Bucket): 9.033ms
ìŠ¹ì: Method 1 (12.0% ë” ë¹ ë¦„)
```

### ğŸ”µ Bucket Sortê°€ ìŠ¹ë¦¬í•œ ê²½ìš° (4ìŠ¹)

#### 1. ì‘ì€ ë°°ì—´ + ë†’ì€ unique (90%)
```
n = 1,000, unique â‰ˆ 900, k = 5
Method 1 (Sort):   0.451ms
Method 2 (Bucket): 0.260ms
ìŠ¹ì: Method 2 (73.7% ë” ë¹ ë¦„) â­â­
```

#### 2. ì¤‘ê°„ ë°°ì—´ + ì¤‘ê°„ unique (30%)
```
n = 10,000, unique â‰ˆ 3,000, k = 10
Method 1 (Sort):   0.691ms
Method 2 (Bucket): 0.661ms
ìŠ¹ì: Method 2 (4.6% ë” ë¹ ë¦„)
```

#### 3. ì¤‘ê°„ ë°°ì—´ + ë†’ì€ unique (90%)
```
n = 10,000, unique â‰ˆ 9,000, k = 10
Method 1 (Sort):   0.959ms
Method 2 (Bucket): 0.838ms
ìŠ¹ì: Method 2 (14.4% ë” ë¹ ë¦„)
```

#### 4. í° ë°°ì—´ + ë†’ì€ unique (90%)
```
n = 100,000, unique â‰ˆ 90,000, k = 10
Method 1 (Sort):   13.935ms
Method 2 (Bucket): 10.531ms
ìŠ¹ì: Method 2 (32.3% ë” ë¹ ë¦„) â­
```

---

## ğŸ” ì„±ëŠ¥ íŒ¨í„´ ë¶„ì„

### Method 1 (Sort) ìš°ì„¸ ì¡°ê±´
- âœ… **ë‚®ì€ unique ratio (< 30%)**
- âœ… ì‘ì€ ë°°ì—´ í¬ê¸°
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ì¤‘ìš”

### Method 2 (Bucket Sort) ìš°ì„¸ ì¡°ê±´
- âœ… **ë†’ì€ unique ratio (> 50%)**
- âœ… í° ë°°ì—´ í¬ê¸° + ë†’ì€ unique
- âœ… ì´ë¡ ì  O(n) í•„ìš”

---

## ğŸ’¡ ì™œ ì´ëŸ° ê²°ê³¼ê°€ ë‚˜ì™”ì„ê¹Œ?

### 1. ë‚®ì€ Unique Ratioì—ì„œ Sort ìŠ¹ë¦¬

```typescript
// n = 100,000, unique = 1,000 (1%)
nums = [1,1,1,1,..., 2,2,2,..., 1000,1000,1000]

// Method 1 (Sort):
// - Map ìƒì„±: O(100,000)
// - 1,000ê°œë§Œ ì •ë ¬: O(1,000 log 1,000) â‰ˆ 10,000 ì—°ì‚°
// ì´: 110,000 ì—°ì‚° âœ“

// Method 2 (Bucket):
// - Map ìƒì„±: O(100,000)
// - 100,001ê°œ ë°°ì—´ ìƒì„±: O(100,001) í•¨ìˆ˜ í˜¸ì¶œ
// ì´: 200,001 ì—°ì‚° âœ—
```

**í•µì‹¬**: SortëŠ” unique elementsë§Œ ì •ë ¬í•˜ì§€ë§Œ, Bucketì€ ì „ì²´ ë°°ì—´ í¬ê¸°ë§Œí¼ ì´ˆê¸°í™”

### 2. ë†’ì€ Unique Ratioì—ì„œ Bucket ìŠ¹ë¦¬

```typescript
// n = 100,000, unique = 90,000 (90%)
nums = [1,2,3,4,5,...,90000] // ê±°ì˜ ëª¨ë‘ ë‹¤ë¥¸ ê°’

// Method 1 (Sort):
// - 90,000ê°œ ì •ë ¬: O(90,000 log 90,000) â‰ˆ 1,520,000 ì—°ì‚° âœ—

// Method 2 (Bucket):
// - 100,001ê°œ ë°°ì—´ ìƒì„±: O(100,001)
// - 90,000ê°œ ì‚½ì…: O(90,000)
// ì´: 190,001 ì—°ì‚° âœ“
```

**í•µì‹¬**: Sortì˜ O(n log n)ì´ nì´ í´ ë•Œ ë¶€ë‹´, Bucketì€ O(n) ìœ ì§€

---

## ğŸ“Š ì‹œê°„ë³µì¡ë„ ì‹¤ì œ vs ì´ë¡ 

### ì´ë¡ ì  ë³µì¡ë„

| Method | ì‹œê°„ë³µì¡ë„ | ê³µê°„ë³µì¡ë„ |
|--------|-----------|-----------|
| Sort | O(n log n) | O(u) |
| Bucket | O(n) | O(n) |

*u = unique elements*

### ì‹¤ì œ ì„±ëŠ¥ (ìƒìˆ˜ ìš”ì¸ í¬í•¨)

| Method | ë‚®ì€ unique (1%) | ì¤‘ê°„ unique (30%) | ë†’ì€ unique (90%) |
|--------|-----------------|------------------|------------------|
| Sort | O(n + u log u) âœ“ | O(n + u log u) â‰ˆ | O(n + u log u) âœ— |
| Bucket | O(2n) âœ— | O(2n) â‰ˆ | O(2n) âœ“ |

**ìƒìˆ˜ ìš”ì¸ì˜ ì¤‘ìš”ì„±**
- Bucketì˜ `Array.from({ length: n+1 }, () => [])` ë¹„ìš©ì´ ì˜ˆìƒë³´ë‹¤ í¼
- SortëŠ” V8 ì—”ì§„ì˜ Timsort ìµœì í™” (C++ ë„¤ì´í‹°ë¸Œ êµ¬í˜„)

---

## ğŸ¯ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ

```typescript
// n = 100,000, unique = 1,000 ê¸°ì¤€

// Method 1 (Sort):
// - Map: 1,000 entries Ã— ~16 bytes = 16KB
// - Array: 1,000 elements Ã— ~8 bytes = 8KB
// ì´ ë©”ëª¨ë¦¬: ~24KB âœ“

// Method 2 (Bucket):
// - Map: 1,000 entries Ã— ~16 bytes = 16KB
// - Buckets: 100,001 arrays Ã— ~48 bytes = 4.8MB âš ï¸
// ì´ ë©”ëª¨ë¦¬: ~4.8MB âœ—

// ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: Bucketì´ 200ë°° ë” í¼!
```

---

## ğŸš€ JavaScript Sortì˜ ë¹„ë°€

### V8 ì—”ì§„ì˜ Array.prototype.sort()

```typescript
// V8ì˜ sort êµ¬í˜„:
// - n < 10: Insertion Sort
// - n >= 10: Timsort (ìµœì í™”ëœ ë³‘í•© ì •ë ¬)

// Timsort íŠ¹ì§•:
// 1. ì•ˆì • ì •ë ¬ (stable sort)
// 2. ë¶€ë¶„ ì •ë ¬ëœ ë°ì´í„°ì— ê°•í•¨
// 3. ìºì‹œ ì¹œí™”ì 
// 4. C++ë¡œ êµ¬í˜„ëœ ë„¤ì´í‹°ë¸Œ ì½”ë“œ (ë¹ ë¦„!)
```

**ì´ë¡ ì  O(n log n)ì´ì§€ë§Œ ì‹¤ì œë¡œëŠ” ë§¤ìš° ë¹ ë¥¸ ìƒìˆ˜ ìš”ì¸**

---

## ğŸ¯ ì‹¤ë¬´ ê¶Œì¥ì‚¬í•­

### âœ… Sortë¥¼ ì‚¬ìš©í•´ì•¼ í•  ë•Œ (Method 1)

#### ì¡°ê±´
1. **Unique ratio < 30%**
2. ë°°ì—´ í¬ê¸° < 10,000
3. ì½”ë“œ ê°„ê²°ì„± ìš°ì„ 
4. ë©”ëª¨ë¦¬ ì œì•½ í™˜ê²½

#### ì‚¬ìš© ì˜ˆì‹œ
```typescript
// ë¡œê·¸ ë¶„ì„ (ì†Œìˆ˜ì˜ ì—ëŸ¬ ì½”ë“œ ë°˜ë³µ)
const errorCodes = [404,404,404,500,500,200,200,...]
topKFrequent1(errorCodes, 5)

// ì‚¬ìš©ì í–‰ë™ ë¶„ì„ (ì†Œìˆ˜ì˜ ì•¡ì…˜ ë°˜ë³µ)
const actions = ['click','click','scroll','click',...]
topKFrequent1(actions, 3)
```

#### ì¥ì 
- âœ… ê°„ê²°í•œ ì½”ë“œ (4ì¤„)
- âœ… ë‚®ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©
- âœ… ìœ ì§€ë³´ìˆ˜ ìš©ì´
- âœ… ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì„±ëŠ¥

### âœ… Bucket Sortë¥¼ ì‚¬ìš©í•´ì•¼ í•  ë•Œ (Method 2)

#### ì¡°ê±´
1. **Unique ratio > 50%**
2. ë°°ì—´ì´ ë§¤ìš° í° ê²½ìš° (> 100,000)
3. ì„±ëŠ¥ì´ ë§¤ìš° ì¤‘ìš”
4. Follow-up ìš”êµ¬ì‚¬í•­ ì¶©ì¡± í•„ìš”

#### ì‚¬ìš© ì˜ˆì‹œ
```typescript
// ì‚¬ìš©ì ID ë¶„ì„ (ê±°ì˜ ëª¨ë‘ unique)
const userIds = [12345, 67890, 11111, 99999, ...]
topKFrequent2(userIds, 10)

// ì„¼ì„œ ë°ì´í„° (ë‹¤ì–‘í•œ ê°’)
const sensorReadings = [23.4, 25.1, 22.8, 24.7, ...]
topKFrequent2(sensorReadings, 5)
```

#### ì¥ì 
- âœ… ì´ë¡ ì  O(n) ë‹¬ì„±
- âœ… ë†’ì€ uniqueì—ì„œ ìš°ìˆ˜
- âœ… Follow-up ë§Œì¡±
- âœ… ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì„ í˜• ì„±ëŠ¥

---

## ğŸŒ³ ì„ íƒ ê¸°ì¤€ ê²°ì • íŠ¸ë¦¬

```
â”Œâ”€ ë°ì´í„° ë¶„ì„ ê°€ëŠ¥?
â”‚
â”œâ”€ Yes
â”‚  â””â”€ unique ratio ê³„ì‚°
â”‚     â”œâ”€ < 30%  â†’ Sort ì‚¬ìš© âœ“
â”‚     â”œâ”€ 30-50% â†’ ë‘˜ ë‹¤ ë¹„ìŠ·
â”‚     â””â”€ > 50%  â†’ Bucket ì‚¬ìš© âœ“
â”‚
â””â”€ No
   â””â”€ Sort ì‚¬ìš© (ì•ˆì „í•œ ì„ íƒ)

â”Œâ”€ í™˜ê²½?
â”‚
â”œâ”€ ì½”ë”© í…ŒìŠ¤íŠ¸ / ë©´ì ‘
â”‚  â””â”€ Follow-up ìˆìŒ?
â”‚     â”œâ”€ Yes â†’ Bucket êµ¬í˜„ (ì´ë¡ ì  ìš°ìˆ˜ì„± ì¦ëª…)
â”‚     â””â”€ No  â†’ Sort êµ¬í˜„ (ë¹ ë¥´ê³  ê°„ë‹¨)
â”‚
â””â”€ í”„ë¡œë•ì…˜ ì½”ë“œ
   â””â”€ Sort ì‚¬ìš© (ìœ ì§€ë³´ìˆ˜ì„± ìš°ì„ )
```

---

## ğŸ“Š ìµœì¢… ë¹„êµí‘œ

| ê¸°ì¤€ | Sort (Method 1) | Bucket (Method 2) |
|------|----------------|------------------|
| **ì‹œê°„ë³µì¡ë„ (ì´ë¡ )** | O(n log n) | O(n) |
| **ì‹œê°„ë³µì¡ë„ (ì‹¤ì œ)** | O(n + u log u) | O(2n) |
| **ê³µê°„ë³µì¡ë„** | O(u) | O(n) |
| **ë‚®ì€ unique** | â­â­â­â­â­ | â­â­ |
| **ë†’ì€ unique** | â­â­â­ | â­â­â­â­â­ |
| **ì½”ë“œ ê°„ê²°ì„±** | â­â­â­â­â­ | â­â­â­ |
| **ë©”ëª¨ë¦¬ íš¨ìœ¨** | â­â­â­â­â­ | â­â­ |
| **ì˜ˆì¸¡ ê°€ëŠ¥ì„±** | â­â­â­â­ | â­â­â­â­â­ |
| **ìœ ì§€ë³´ìˆ˜ì„±** | â­â­â­â­â­ | â­â­â­ |

---

## ğŸ“ í•µì‹¬ êµí›ˆ

### 1. ì´ë¡  vs ì‹¤ì œ
> **"Big-OëŠ” ì¶©ë¶„íˆ í° nì— ëŒ€í•œ ì´ì•¼ê¸°ë‹¤"**

- ì´ë¡ ì ìœ¼ë¡œ O(n) < O(n log n)
- í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ìƒìˆ˜ ìš”ì¸ì´ ì¤‘ìš”
- ë°ì´í„° íŠ¹ì„± (unique ratio)ì´ ì„±ëŠ¥ì„ ì¢Œìš°

### 2. ì´ˆê¸°í™” ë¹„ìš©ì˜ ì¤‘ìš”ì„±
> **"Bucket Sortì˜ ìˆ¨ê²¨ì§„ ë¹„ìš©"**

```typescript
Array.from({ length: n + 1 }, () => [])
// ì´ í•œ ì¤„ì´:
// - n+1ë²ˆ í•¨ìˆ˜ í˜¸ì¶œ
// - n+1ê°œ ë°°ì—´ ê°ì²´ ìƒì„±
// - ìƒë‹¹í•œ GC ì••ë ¥
```

### 3. JavaScript ì—”ì§„ì˜ ìµœì í™”
> **"ë‚´ì¥ í•¨ìˆ˜ëŠ” ì´ìœ ê°€ ìˆì–´ì„œ ë¹ ë¥´ë‹¤"**

- V8ì˜ sortëŠ” C++ë¡œ êµ¬í˜„
- Timsort ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©
- ë¶€ë¶„ ì •ë ¬, ìºì‹œ ìµœì í™” ë“± ì ìš©
- ìˆœìˆ˜ JS êµ¬í˜„ë³´ë‹¤ 10-20ë°° ë¹ ë¦„

### 4. ë°ì´í„° íŠ¹ì„±ì˜ ì¤‘ìš”ì„±
> **"ì•Œê³ ë¦¬ì¦˜ ì„ íƒì€ ë°ì´í„°ë¥¼ ë³´ê³  ê²°ì •í•˜ë¼"**

- Unique ratioê°€ 30% ê¸°ì¤€ì 
- ë‚®ìœ¼ë©´ Sort, ë†’ìœ¼ë©´ Bucket
- ë°ì´í„° ë¶„ì„ ì—†ì´ëŠ” Bucketì´ ë” ëŠë¦´ ìˆ˜ ìˆìŒ

---

## ğŸ’¼ ì‹¤ë¬´ ì¶”ì²œ ê°€ì´ë“œ

### ê¸°ë³¸ ì›ì¹™
```typescript
// ì¼ë°˜ì ì¸ ê²½ìš°: Sort ì‚¬ìš© (ê°„ê²°ì„±, ì•ˆì •ì„±)
function topKFrequent(nums: number[], k: number): number[] {
    const freqMap = new Map();
    nums.forEach(n => freqMap.set(n, (freqMap.get(n) || 0) + 1));

    return Array.from(freqMap.entries())
        .sort((a, b) => b[1] - a[1])
        .slice(0, k)
        .map(a => a[0]);
}
```

### ì„±ëŠ¥ì´ ì¤‘ìš”í•œ ê²½ìš°: Adaptive ë°©ì‹
```typescript
function topKFrequentAdaptive(nums: number[], k: number): number[] {
    const freqMap = new Map();
    nums.forEach(n => freqMap.set(n, (freqMap.get(n) || 0) + 1));

    const uniqueRatio = freqMap.size / nums.length;

    // unique ratioê°€ 50% ì´ìƒì´ë©´ Bucket Sort
    if (uniqueRatio > 0.5) {
        return bucketSortMethod(nums, k, freqMap);
    } else {
        return sortMethod(freqMap, k);
    }
}
```

---

## ğŸ ìµœì¢… ê²°ë¡ 

### í•œ ì¤„ ìš”ì•½
> **"ì´ë¡ ì ìœ¼ë¡œ Bucketì´ ìš°ìˆ˜í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ë°ì´í„° íŠ¹ì„±ì— ë”°ë¼ Sortê°€ ë” ë¹ ë¥¼ ìˆ˜ ìˆë‹¤"**

### ì‹¤ë¬´ ê°€ì´ë“œ
- **LeetCode/ë©´ì ‘**: Bucket Sort êµ¬í˜„ (Follow-up ë§Œì¡±)
- **í”„ë¡œë•ì…˜**: Sort ì‚¬ìš© (ê°„ê²°ì„±, ìœ ì§€ë³´ìˆ˜ì„±)
- **ì„±ëŠ¥ ìµœì í™”**: ë°ì´í„° ë¶„ì„ í›„ ì„ íƒ (Adaptive)

### ë°°ìš´ ì 
1. Big-OëŠ” ì „ì²´ ì´ì•¼ê¸°ê°€ ì•„ë‹ˆë‹¤
2. ìƒìˆ˜ ìš”ì¸ë„ ì¤‘ìš”í•˜ë‹¤
3. ë°ì´í„° íŠ¹ì„±ì„ ì´í•´í•˜ë¼
4. ë‚´ì¥ í•¨ìˆ˜ë¥¼ ì‹ ë¢°í•˜ë¼
5. ê°„ê²°í•œ ì½”ë“œê°€ ì¢…ì¢… ë” ë¹ ë¥´ë‹¤

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [LeetCode 347. Top K Frequent Elements](https://leetcode.com/problems/top-k-frequent-elements/)
- [V8 Sort Implementation](https://v8.dev/blog/array-sort)
- [Timsort Algorithm](https://en.wikipedia.org/wiki/Timsort)
- Benchmark Code: `benchmark.ts`
